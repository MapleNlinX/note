# XSS思路整理

1、寻找注入点

2、找闭合方法，查看是否成功

3、查看前端，如果是把<>过滤，则通过构造onclik、onmouseenter=等方法

4、如果是script被过滤，则尝试大小写、双写、实体编码等绕过

常见的XSS的绕过编码：JS编码、HTML实体编码、URL编码、Hex编码等

常用测试语句：script、onerror=、onload=、href=、onclick=、onfocus等

常见的实体编码：

| 显示 | 实体名字   | 实体编码   |
| -- | ------ | ------ |
| <  | \&lt;  | \&#60; |
| >  | \&gt;  | \&#62; |
| &  | \&amp; | \&#38; |
| "  | \&quot | \&#34; |

防御：

-   过滤
-   对内容进行编码
-   在http头部加入httponly 防止js获取cookie
-   使用https加密数据

无脑试标签，直接来

1、一般不会那么快就行，看看源码，寻求闭合方法    **">**

闭合完发现还是不行的，继续查看源码

### 第一种情况，script没被过滤，<>被过滤了

如果输入的字符如原样但不出结果，可能有毒逼用htmlspecialchars()把<>给编码整没了，那就别试标签了，   一律放屁

直接在一个标签内构造事件搞他，onclick，onmousemove等

`一个标签指的是闭合的时候不要用>就行，虽然你打也没有用，但理论是那么个理论，看源码用单双引号即可`

### 另一种情况，<>没被过滤，script等标签被过滤了

-   好办，如果是那种变成 scrip\_t 的试试大小写，大小写绕不过就实体编码，注意判断源码中的关键字审计不会审计编码后的字符
-   如果是script等的标签直接被整没了，直接变空格了，双写就行，scrscriptipt 乱杀

### 究极情况：我在页面URL输参数，回显屁都看不到

-   先看源码
-   找input函数，看看有没有隐藏的参数，属性为hidden的隐藏输入框，这就是注入点
-   看看隐藏参数对应键值，可能是抓取ua,referer,cookie中的数据进行赋值
-   对其闭合
-   type改为text
-   然后该干嘛干嘛
